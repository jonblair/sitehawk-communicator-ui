{"ast":null,"code":"import { ColumnDefaultProps } from '../ColumnProps';\n/**\n * @hidden\n */\n\nexport function mapColumns(columns) {\n  var columnsMap = [[]];\n  var stickyLeftWidth = 0;\n\n  for (var q = columns.length - 1; q >= 0; q--) {\n    columns[q].colSpan = columns[q].colSpan || 1;\n\n    if (columns[q].parentIndex !== -1) {\n      columns[columns[q].parentIndex].colSpan = (columns[columns[q].parentIndex].colSpan || 0) + columns[q].colSpan;\n    }\n  }\n\n  var maxDepth = 0;\n  columns.forEach(function (d) {\n    maxDepth = Math.max(maxDepth, d.depth);\n  });\n  var rowSpan = 1;\n  columns.forEach(function (column, i) {\n    columnsMap[column.depth] = columnsMap[column.depth] || [];\n    var needKFirst = false;\n\n    if (columnsMap[column.depth].length === 0) {\n      if (rowSpan <= 1) {\n        rowSpan = 1 + (column.children.length > 0 ? 0 : maxDepth - column.depth);\n      } else {\n        rowSpan--;\n        needKFirst = true;\n      }\n    }\n\n    column.rowSpan = 1 + (column.children.length > 0 ? 0 : maxDepth - column.depth);\n    column.kFirst = needKFirst;\n    column.index = columnsMap[column.depth].length;\n    columnsMap[column.depth].push(i);\n\n    if (column.locked && column.children.length === 0) {\n      column.left = stickyLeftWidth;\n      stickyLeftWidth += column.width ? parseFloat(column.width.toString()) : 0;\n    }\n  });\n  var nextIsLocked = false;\n  var stickyRightWidth = 0;\n\n  for (var i = columns.length - 1; i >= 0; i--) {\n    var column = columns[i];\n\n    if (column.locked && column.children.length === 0) {\n      column.right = stickyRightWidth;\n      stickyRightWidth += column.width ? parseFloat(column.width.toString()) : 0;\n      column.rightBorder = !nextIsLocked;\n    }\n\n    nextIsLocked = column.locked || false;\n  }\n\n  return columnsMap;\n}\n/**\n * @hidden\n */\n\nexport function readColumns(elements, depth) {\n  if (depth === void 0) {\n    depth = 0;\n  }\n\n  var columns = [];\n\n  if (!elements || !elements.length) {\n    return [];\n  }\n\n  elements.forEach(function (columnProps) {\n    var children = readColumns(columnProps.children || [], depth + 1);\n    columns.push(Object.assign({}, {\n      depth: depth\n    }, ColumnDefaultProps, columnProps, {\n      declarationIndex: columns.length,\n      children: children,\n      rowSpan: 0,\n      colSpan: 0\n    }));\n  });\n\n  var comparator = function (a, b) {\n    return a.orderIndex === b.orderIndex ? a.declarationIndex - b.declarationIndex : (a.orderIndex || 0) - (b.orderIndex || 0);\n  };\n\n  columns.sort(comparator);\n\n  if (depth === 0) {\n    var ret_1 = [];\n\n    var flat_1 = function (cols, pIndex) {\n      return cols.forEach(function (c) {\n        c.parentIndex = pIndex;\n        flat_1(c.children, ret_1.push(c) - 1);\n      });\n    };\n\n    flat_1(columns, -1);\n    return ret_1;\n  }\n\n  return columns;\n}\n/**\n * @hidden\n */\n\nexport function isRtl(element) {\n  return Boolean(element && getComputedStyle(element).direction === 'rtl');\n}\n/**\n * @hidden\n */\n\nexport function getIndex(event, parent) {\n  if (!parent || !event || !event.originalEvent) {\n    return -1;\n  }\n\n  var target = document.elementFromPoint(event.clientX, event.originalEvent.clientY);\n\n  while (target && target.parentElement !== parent) {\n    target = target.parentElement;\n  }\n\n  var children = parent.children;\n\n  for (var i = 0; i < children.length; i++) {\n    if (children[i] === target) {\n      return i;\n    }\n  }\n\n  return -1;\n}","map":{"version":3,"sources":["../../../../src/header/utils/index.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { ColumnDefaultProps } from '../ColumnProps';\n/**\n * @hidden\n */\nexport function mapColumns(columns) {\n    var columnsMap = [[]];\n    var stickyLeftWidth = 0;\n    for (var q = columns.length - 1; q >= 0; q--) {\n        columns[q].colSpan = columns[q].colSpan || 1;\n        if (columns[q].parentIndex !== -1) {\n            columns[columns[q].parentIndex].colSpan =\n                (columns[columns[q].parentIndex].colSpan || 0) + columns[q].colSpan;\n        }\n    }\n    var maxDepth = 0;\n    columns.forEach(function (d) { maxDepth = Math.max(maxDepth, d.depth); });\n    var rowSpan = 1;\n    columns.forEach(function (column, i) {\n        columnsMap[column.depth] = columnsMap[column.depth] || [];\n        var needKFirst = false;\n        if (columnsMap[column.depth].length === 0) {\n            if (rowSpan <= 1) {\n                rowSpan = 1 + (column.children.length > 0 ? 0 : maxDepth - column.depth);\n            }\n            else {\n                rowSpan--;\n                needKFirst = true;\n            }\n        }\n        column.rowSpan = 1 + (column.children.length > 0 ? 0 : maxDepth - column.depth);\n        column.kFirst = needKFirst;\n        column.index = columnsMap[column.depth].length;\n        columnsMap[column.depth].push(i);\n        if (column.locked && column.children.length === 0) {\n            column.left = stickyLeftWidth;\n            stickyLeftWidth += column.width ? parseFloat(column.width.toString()) : 0;\n        }\n    });\n    var nextIsLocked = false;\n    var stickyRightWidth = 0;\n    for (var i = columns.length - 1; i >= 0; i--) {\n        var column = columns[i];\n        if (column.locked && column.children.length === 0) {\n            column.right = stickyRightWidth;\n            stickyRightWidth += column.width ? parseFloat(column.width.toString()) : 0;\n            column.rightBorder = !nextIsLocked;\n        }\n        nextIsLocked = column.locked || false;\n    }\n    return columnsMap;\n}\n/**\n * @hidden\n */\nexport function readColumns(elements, depth) {\n    if (depth === void 0) { depth = 0; }\n    var columns = [];\n    if (!elements || !elements.length) {\n        return [];\n    }\n    elements.forEach(function (columnProps) {\n        var children = readColumns(columnProps.children || [], depth + 1);\n        columns.push(Object.assign({}, { depth: depth }, ColumnDefaultProps, columnProps, {\n            declarationIndex: columns.length,\n            children: children,\n            rowSpan: 0,\n            colSpan: 0\n        }));\n    });\n    var comparator = function (a, b) {\n        return a.orderIndex === b.orderIndex ?\n            a.declarationIndex - b.declarationIndex :\n            ((a.orderIndex || 0) - (b.orderIndex || 0));\n    };\n    columns.sort(comparator);\n    if (depth === 0) {\n        var ret_1 = [];\n        var flat_1 = function (cols, pIndex) {\n            return cols.forEach(function (c) {\n                c.parentIndex = pIndex;\n                flat_1(c.children, ret_1.push(c) - 1);\n            });\n        };\n        flat_1(columns, -1);\n        return ret_1;\n    }\n    return columns;\n}\n/**\n * @hidden\n */\nexport function isRtl(element) {\n    return Boolean(element && getComputedStyle(element).direction === 'rtl');\n}\n/**\n * @hidden\n */\nexport function getIndex(event, parent) {\n    if (!parent || !event || !event.originalEvent) {\n        return -1;\n    }\n    var target = document.elementFromPoint(event.clientX, event.originalEvent.clientY);\n    while (target && target.parentElement !== parent) {\n        target = target.parentElement;\n    }\n    var children = parent.children;\n    for (var i = 0; i < children.length; i++) {\n        if (children[i] === target) {\n            return i;\n        }\n    }\n    return -1;\n}\n//# sourceMappingURL=index.js.map"]},"metadata":{},"sourceType":"module"}